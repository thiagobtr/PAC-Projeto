title = '',
tickfont = list(
size = 14)))
OpCredito%>%
group_by(Interessado,Data)%>%
filter(Status == 'Deferido',Real ==TRUE, Interessado %in% c('Rio de Janeiro','São Paulo', 'Goiás'))%>%
summarise(ValorTotal = sum(Valor))%>%
arrange(desc(ValorTotal))%>%
filter(row_number()<=10)%>%
plot_ly(x = ~Data, y = ~ValorTotal,color= ~ Interessado
,text = ~FormataValor(ValorTotal))%>%
add_lines()%>%
add_markers()%>%
layout(title = 'Valores Recebidos - 3 Maiores Interessados',
xaxis = list(
title = '',
tickfont = list(
size = 14)),
yaxis= list(
title = '',
tickfont = list(
size = 14)))
OpCredito%>%
group_by(Interessado,Data)%>%
filter(Status == 'Deferido',Real ==TRUE, Interessado %in% c('Rio de Janeiro','São Paulo', 'Goiás'))%>%
summarise(ValorTotal = sum(Valor))%>%
arrange(desc(ValorTotal))%>%
filter(row_number()<=10)%>%
plot_ly(x = ~Data, y = ~ValorTotal,color= ~ Interessado
,text = ~FormataValor(ValorTotal)
,mode = 'line+markers')%>%
layout(title = 'Valores Recebidos - 3 Maiores Interessados',
xaxis = list(
title = '',
tickfont = list(
size = 14)),
yaxis= list(
title = '',
tickfont = list(
size = 14)))
OpCredito%>%
group_by(Interessado,Data)%>%
filter(Status == 'Deferido',Real ==TRUE, Interessado %in% c('Rio de Janeiro','São Paulo', 'Goiás'))%>%
summarise(ValorTotal = sum(Valor))%>%
arrange(desc(ValorTotal))%>%
filter(row_number()<=10)%>%
plot_ly(x = ~Data, y = ~ValorTotal,color= ~ Interessado
,text = ~FormataValor(ValorTotal)
,mode = 'line')%>%
layout(title = 'Valores Recebidos - 3 Maiores Interessados',
xaxis = list(
title = '',
tickfont = list(
size = 14)),
yaxis= list(
title = '',
tickfont = list(
size = 14)))
OpCredito%>%
group_by(Interessado,Data)%>%
filter(Status == 'Deferido',Real ==TRUE, Interessado %in% c('Rio de Janeiro','São Paulo', 'Goiás'))%>%
summarise(ValorTotal = sum(Valor))%>%
arrange(desc(ValorTotal))%>%
filter(row_number()<=10)%>%
plot_ly(x = ~Data, y = ~ValorTotal,color= ~ Interessado
,text = ~FormataValor(ValorTotal)
,type = 'scatter')%>%
layout(title = 'Valores Recebidos - 3 Maiores Interessados',
xaxis = list(
title = '',
tickfont = list(
size = 14)),
yaxis= list(
title = '',
tickfont = list(
size = 14)))
OpCredito%>%
group_by(Interessado,Data)%>%
filter(Status == 'Deferido',Real ==TRUE, Interessado %in% c('Rio de Janeiro','São Paulo', 'Goiás'))%>%
summarise(ValorTotal = sum(Valor))%>%
arrange(desc(ValorTotal))%>%
filter(row_number()<=10)%>%
plot_ly(x = ~Data, y = ~ValorTotal,color= ~ Interessado
,text = ~FormataValor(ValorTotal)
,type = 'line')%>%
layout(title = 'Valores Recebidos - 3 Maiores Interessados',
xaxis = list(
title = '',
tickfont = list(
size = 14)),
yaxis= list(
title = '',
tickfont = list(
size = 14)))
OpCredito%>%
group_by(Interessado,Data)%>%
filter(Status == 'Deferido',Real ==TRUE, Interessado %in% c('Rio de Janeiro','São Paulo', 'Goiás'))%>%
summarise(ValorTotal = sum(Valor))%>%
arrange(desc(ValorTotal))%>%
filter(row_number()<=10)%>%
plot_ly(x = ~Data, y = ~ValorTotal,color= ~ Interessado
,text = ~FormataValor(ValorTotal))%>%
add_lines()%>%
layout(title = 'Valores Recebidos - 3 Maiores Interessados',
xaxis = list(
title = '',
tickfont = list(
size = 14)),
yaxis= list(
title = '',
tickfont = list(
size = 14)))
OpCredito%>%
group_by(Credor,Data)%>%
filter(Status == 'Deferido',Real ==TRUE, Credor %in% c('Banco Nacional de Desenvolvimento Econômico e Social',
'Caixa Econômica Federal','Banco do Brasil S/A'))%>%
summarise(ValorTotal = sum(Valor))%>%
#arrange(Data)%>%
plot_ly(x = ~ Data, y = ~ ValorTotal
,text = ~FormataValor(ValorTotal)
,type = 'scatter'
,mode = 'markers',
color = ~ Credor)%>%
layout(title = 'Concessao de Créditos Deferidos <br> 3 Maiores Credores',
xaxis = list(
title = '',
tickfont = list(
size = 14)),
yaxis= list(
title = '',
tickfont = list(
size = 14)))
save(OpCredito,'OpCredito')
save(OpCredito,'OpCredito.rds')
saveRDS(OpCredito,'OpCredito.rds')
readRDS('OpCredito.rds')
knitr::opts_chunk$set(echo = TRUE)
library ('data.table')
library ('lubridate')
library('ggplot2')
library('dplyr')
library('outliers')
library('ggthemes')
library('plotly')
OpCredito <- readRDS('OpCredito.rds')
OpCredito <- load('OpCredito.rds')
OpCredito <- load('/home/dataanalysis/OpCredito.rds')
OpCredito <- readRDS('/home/dataanalysis/OpCredito.rds')
OpCredito%>%
group_by(Interessado,Ano)%>%
filter(Ano==2013, Status=='Deferido',Real==TRUE )%>%
summarise(Valor2 = sum(Valor))%>%
arrange(desc(Valor2))%>%
group_by(Ano)%>%
filter(row_number()<=10)%>%
plot_ly(x = ~reorder(Interessado,Valor2) , y = ~Valor2, text = ~FormataValor(Valor2)
, hoverinfo = 'text')%>%
#add_trace( x = ~Interessado, y = ~Valor)%>%
#add_markers(color = ~Interessado) %>%
#add_text(text = ~UF)%>%
add_bars()%>%
layout(title = '2010 - Ano com Maior Operação de Credito <br>10 Maiores Valores',
xaxis = list(title = ''),
yaxis= list(title = ''))
OpCredito%>%
group_by(Ano,Status)%>%
filter(Status != 'Deferido',Real == TRUE)%>%
summarise(ValorTotal = sum(Valor),Qtd = n())%>%
plot_ly(x = ~ factor(Ano) , y = ~Qtd,color= ~ Status
,text = ~FormataValor(ValorTotal))%>%
add_bars()%>%
layout(title = 'Creditos Nao Deferidos - Anual',
xaxis = list(
title = '',
tickfont = list(
size = 14)),
yaxis= list(
title = '',
tickfont = list(
size = 14)))
OpCredito%>%
group_by(Ano,Status)%>%
filter(Status != 'Deferido',Real == TRUE)%>%
summarise(ValorTotal = sum(Valor),Qtd = n())%>%
mutate(Perc = round(ValorTotal/sum(ValorTotal),2))%>%
plot_ly(x = ~ factor(Ano) , y = ~Perc,color= ~ Status
,text = ~FormataValor(ValorTotal))%>%
add_bars()%>%
layout(title = 'Creditos Nao Deferidos - Anual',
xaxis = list(
title = '',
tickfont = list(
size = 14)),
yaxis= list(
title = '',
tickfont = list(
size = 14)))
OpCredito%>%
group_by(Ano,Status)%>%
filter(Status != 'Deferido',Real == TRUE)%>%
summarise(ValorTotal = sum(Valor),Qtd = n())%>%
mutate(Perc = round(ValorTotal/sum(ValorTotal),2))%>%
plot_ly(x = ~ factor(Ano) , y = ~ValorTotal,color= ~ Status
,text = ~FormataValor(ValorTotal))%>%
add_boxplot()%>%
layout(title = 'Creditos Nao Deferidos - Anual',
xaxis = list(
title = '',
tickfont = list(
size = 14)),
yaxis= list(
title = '',
tickfont = list(
size = 14)))
OpCredito%>%
group_by(Ano)%>%
#filter(Status != 'Deferido',Real == TRUE)%>%
summarise(ValorTotal = sum(Valor),Qtd = n())%>%
plot_ly(x = ~ factor(Ano) , y = ~ValorTotal
,text = ~FormataValor(ValorTotal))%>%
add_boxplot()%>%
layout(title = 'Creditos Nao Deferidos - Anual',
xaxis = list(
title = '',
tickfont = list(
size = 14)),
yaxis= list(
title = '',
tickfont = list(
size = 14)))
OpCredito%>%
group_by(Ano)%>%
#filter(Status != 'Deferido',Real == TRUE)%>%
summarise(ValorTotal = sum(Valor),Qtd = n())%>%
plot_ly(x = ~ factor(Ano) , y = ~ValorTotal)%>%
add_boxplot()%>%
layout(title = 'Creditos Nao Deferidos - Anual',
xaxis = list(
title = '',
tickfont = list(
size = 14)),
yaxis= list(
title = '',
tickfont = list(
size = 14)))
OpCredito%>%
group_by(Ano)%>%
#filter(Status != 'Deferido',Real == TRUE)%>%
summarise(ValorTotal = sum(Valor),Qtd = n())%>%
plot_ly(x = ~ factor(Ano) , y = ~ValorTotal
,type ='box')%>%
layout(title = 'Creditos Nao Deferidos - Anual',
xaxis = list(
title = '',
tickfont = list(
size = 14)),
yaxis= list(
title = '',
tickfont = list(
size = 14)))
OpCredito%>%
group_by(Ano)%>%
#filter(Status != 'Deferido',Real == TRUE)%>%
summarise(ValorTotal = sum(Valor),Qtd = n())%>%
plot_ly( y = ~ValorTotal
,type ='box')%>%
layout(title = 'Creditos Nao Deferidos - Anual',
xaxis = list(
title = '',
tickfont = list(
size = 14)),
yaxis= list(
title = '',
tickfont = list(
size = 14)))
OpCredito%>%
group_by(Ano)%>%
#filter(Status != 'Deferido',Real == TRUE)%>%
summarise(ValorTotal = sum(Valor),Qtd = n())%>%
plot_ly( y = ~ValorTotal
,type ='box'
,color =~Ano)%>%
layout(title = 'Creditos Nao Deferidos - Anual',
xaxis = list(
title = '',
tickfont = list(
size = 14)),
yaxis= list(
title = '',
tickfont = list(
size = 14)))
OpCredito%>%
group_by(Ano)%>%
#filter(Status != 'Deferido',Real == TRUE)%>%
summarise(ValorTotal = sum(Valor),Qtd = n())%>%
plot_ly( y = ~ValorTotal
,color =~ Ano
,type ='box')%>%
layout(title = 'Creditos Nao Deferidos - Anual',
xaxis = list(
title = '',
tickfont = list(
size = 14)),
yaxis= list(
title = '',
tickfont = list(
size = 14)))
OpCredito%>%
group_by(Ano)%>%
#filter(Status != 'Deferido',Real == TRUE)%>%
plot_ly( y = ~ValorTotal
,color =~ Ano
,type ='box')%>%
layout(title = 'Creditos Nao Deferidos - Anual',
xaxis = list(
title = '',
tickfont = list(
size = 14)),
yaxis= list(
title = '',
tickfont = list(
size = 14)))
OpCredito%>%
group_by(Ano)%>%
#filter(Status != 'Deferido',Real == TRUE)%>%
summarise(ValorTotal = sum(Valor),Qtd = n())%>%
select(Ano,ValorTotal)
OpCredito%>%
group_by(Ano)%>%
#filter(Status != 'Deferido',Real == TRUE)%>%
#summarise(ValorTotal = sum(Valor),Qtd = n())%>%
plot_ly( y = ~Valor
,color =~ Ano
,type ='box')%>%
layout(title = 'Creditos Nao Deferidos - Anual',
xaxis = list(
title = '',
tickfont = list(
size = 14)),
yaxis= list(
title = '',
tickfont = list(
size = 14)))
plot_ly(OpCredito, y = ~Valor
,color =~ Ano
,type ='box')
plot_ly(OpCredito, y = ~Valor
,color =~ factor(Ano)
,type ='box')
plot_ly(OpCredito, y = ~Valor
,color =~ factor(Ano)
,type ='boxplot')
plot_ly(ggplot2::diamonds, y = ~price, color = ~cut, type = "box")
plot_ly(OpCredito
,y = ~Valor
,color = ~factor(Ano)
,type ='box')
plot_ly(OpCredito
,y = ~Valor
,color = ~Status
,type ='box')
OpCredito%>%
filter(Status != 'Deferido',Real == TRUE)%>%
#summarise(ValorTotal = sum(Valor),Qtd = n())%>%
plot_ly(OpCredito
,y = ~Valor
,color = ~Status
,type ='box')
OpCredito%>%
filter(Status != 'Deferido',Real == TRUE)%>%
#summarise(ValorTotal = sum(Valor),Qtd = n())%>%
plot_ly(y = ~Valor
,color = ~Status
,type ='box')
OpCredito%>%
filter(Status != 'Deferido',Real == TRUE)%>%
#summarise(ValorTotal = sum(Valor),Qtd = n())%>%
plot_ly(y = ~Valor
,color = ~factor(Ano)
,type ='box')%>%
OpCredito%>%
filter(Status != 'Deferido',Real == TRUE)%>%
#summarise(ValorTotal = sum(Valor),Qtd = n())%>%
plot_ly(y = ~Valor
,color = ~factor(Ano)
,type ='box')
OpCredito%>%
filter(Status != 'Deferido',Real == TRUE)%>%
#summarise(ValorTotal = sum(Valor),Qtd = n())%>%
plot_ly(y = ~Valor
,color = ~factor(Ano)
,type ='box')
OpCredito%>%
filter(Status != 'Deferido',Real == TRUE,Ano %in% list(2002,2003))%>%
#summarise(ValorTotal = sum(Valor),Qtd = n())%>%
plot_ly(y = ~Valor
,color = ~factor(Ano)
,type ='box')
print('teste')
version
print('teste')
version
install.packagec(c('ggplot2','lubridate','dplyr'))
install.packages(c('ggplot2','lubridate','dplyr'))
library('ggplot2')
library('dplyr')
library('lubridate')
library('stringr')
setwd('/media/sf_FormacaoCientistaDeDados/Portfolio/AnaliseBrasil')
pac <- data.frame(read.csv('Data/Pac_2018_12.csv',header=TRUE,sep=',',fileEncoding='latin1'
, stringsAsFactors =FALSE))
#arquivo Pac 2
pac_2014 <- data.frame(read.csv('Data/PAC_2014_10.csv',header=TRUE,sep=';',fileEncoding='latin1'
, stringsAsFactors =FALSE))
#Siglas e estados
sigla_uf<- data.frame(read.csv('Data/Estados_Siglas.txt',header=TRUE,sep = '\t',
stringsAsFactors = FALSE))
#Dados de saneamento
saneam <- data.frame(read.csv('Data/IndicadoresSaneamentoGeral.csv',header=TRUE,sep=';'
,fileEncoding = 'latin1',stringsAsFactors = FALSE))
#Variavel investimento_total recebendo valor mais recente
pac_2014$investimento_total<-ifelse(is.na(pac_2014$investimento_total),
ifelse(is.na(pac_2014$val_pos_2014),pac_2014$val_2011_2014,
pac_2014$val_pos_2014),pac_2014$investimento_total)
pac_2014$val_pos_2014=NULL
pac_2014$val_2011_2014=NULL
col_names<- colnames(pac)
names(pac_2014)<- col_names
pac_total<- rbind(pac,pac_2014)
remove(pac_2014)
pac_total$data_ciclo = as.Date(pac_total$dat_ciclo,"%d/%m/%Y")
pac_total$data_conclusao = as.Date(pac_total$dat_conclusao_revisada,"%d/%m/%Y")
pac_total$data_selecao = as.Date(pac_total$dat_selecao,"%d/%m/%Y")
pac_total$dat_ciclo = NULL
pac_total$dat_conclusao_revisada = NULL
pac_total$dat_selecao = NULL
pac_total$lat<-str_replace_all(pac_total$obra_latitude,"\\D","")
pac_total$lon<-str_replace_all(pac_total$obra_longitude,"\\D","")
pac_total<- select(pac_total,-c(obra_latitude,obra_longitude))
estagio_obras = tibble (
codigo = c(0,3,5,10,40,41,42,70,71,90,91),
descricao= c('Nao informado', 'A selecionar','Em contratação','Ação Preparatória',
'Em licitação de obra','Em licitação de projeto','Em execução de projeto',
'Em obras','Em execução','Concluído','Em operação'))
tipos_empr = tibble(
tipo <- c('Rodovias','Ferrovia','Porto', 'Hidrovia','Aeroporto'
,'Defesa','Comunicaçoes','Ciencia e Tecnologia'
,'Geração de Energia Elétrica','Transmissão de Energia Elétrica','Petróleo e Gás Natural'
,'Geologia e Mineração - Cprm','Marinha Mercante','Combustíveis Renováveis','Saneamento'
,'Água em áreas urbanas','Prevenção em áreas de risco','Pavimentação','Mobilidade Urbana'
,'Cidades Digitais','Cidades Históricas','Infraestrutura Turística','Olimpíadas'
,'Educação','Saúde','SUFRAMA','Casa da Mulher Brasileira','UBS','UPA','Creches e Pré Escolas'
,'Quadras Esportivas nas Escolas','Centro de Artes e Esportes Unificados'
,'Centro de Iniciação ao Esporte','MCMV','Urbanização de assentamentos precários'
,'Financiamento SBPE','Luz para Todos','Recursos Hídricos','Água em áreas urbanas','Estradas Vicinais'),
subeixo <-c(rep('Infraestrutura Logística',8),rep('Infraestrutura Energética',6),
rep('Infraestrutura Social e Urbana',24),'Infraestrutura Social e Urbana','Infraestrutura Logística'),
idn_digs <- c(1000,1001,1002,1003,1004,1006,1007,1008,2000,2001,2002,2003,2004,2005,3000,3000,
3001,3002,3003,3004,3005,3006,3007,3011,3012,3013,3009,4000,4001,4002,4003,4004,
4005,5000,5001,5002,6000,6002,6001,1005),.name_repair= ~ c('tipo','subeixo','idn_digs')
)
pac_total<-left_join(pac_total,estagio_obras,by = c("idn_estagio"= "codigo"))
pac_total<- left_join(pac_total,tipos_empr,by = c("id_digs"="idn_digs"))
pac_total<- pac_total%>%
mutate(Qtd_uf= str_count(sig_uf,"[A-Z]")/2)%>%
select(idn_empreendimento:subeixo,Qtd_uf)
pac_total <- pac_total%>%filter(Qtd_uf==1)%>%
inner_join(sigla_uf,by=c("sig_uf"="SIGLA"))
pac_total<- pac_total%>%
select(idn_empreendimento:ESTADOS)%>%
mutate(
Regiao=case_when(
sig_uf %in% c('RS','PR','SC')~'Sul',
sig_uf %in% c('SP','RJ','ES','MG')~'Sudeste',
sig_uf %in% c('DF','MT','MS','GO')~'Centro-Oeste',
sig_uf %in% c('BA','PE','PB','CE','MA','RN','SE','AL','PI')~'Nordeste',
sig_uf %in% c('AM','TO','RR','AP','PA','AC','RO')~'Norte',
)
)
pac_total$idn_empreendimento=NULL
pac_total$id_digs=NULL
pac_total$idn_estagio=NULL
pac_total$Qtd_uf=NULL
pac_total%>%filter(is.na(investimento_total))%>%
group_by(data_ciclo)%>%
count(investimento_total)
pac_total_valor <- pac_total%>%filter(!is.na(investimento_total))
pac_total$investimento_total<-ifelse(is.na(pac_total$investimento_total)
,0,pac_total$investimento_total)
medidas<-function(valor){
tibble('media'=mean(valor),
'mediana'= median(valor),
'sd'= sd(valor))
}
moda <- function(valor){
calc<- table(valor)
names(calc) [calc == max(calc)]
}
medidas(pac_total_valor$investimento_total)
moda(pac_total_valor$investimento_total)
amp(pac_total_valor$investimento_total)
pac_total%>%
filter(investimento_total==0)%>%
tally()
quantile(pac_total_valor$investimento_total,0.25)
quantile(pac_total_valor$investimento_total)
format(quantile(pac_total_valor$investimento_total),scientific = F)
library(psycho)
install.packages(pyscho)
install.packages(psycho)
install.packages('psycho')
install.packages('psycho')
